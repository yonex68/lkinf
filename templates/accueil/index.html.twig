{% extends 'base.html.twig' %}

{% block body %}

{% include "accueil/_banner_slider.html.twig" %}

<section class="pb-5">
	<div class="view_slider recommended">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<h3 class="text-white">Les plus rescents</h3>
					<div class="view recent-slider recommended-slider">
						{% for microservice in lastedServices() %}
						{{ include('microservice/composants/_bloc.html.twig') }}
						{% endfor %}
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<div class="market-wrapper py-5">
	<div class="container">
		<h2 class="text-center">Catégories</h2>
		<ul class="categories-list mb-0">
			{% for categorie in categories %}
			<li class="my-3">
				<a href="{{ path('microservices_categories', {slug: categorie.slug}) }}">
					{% if categorie.icone %}

					<img src="{{ vich_uploader_asset(categorie, 'iconeFile') | imagine_filter('small_avatar') }}"
						alt="{{ categorie.name }}" loading="lazy" class="rounded-circle">

					{% else %}

					<img src="{{ asset('themes/base/images/graphics.svg') }}" alt="{{ categorie.name }}" loading="lazy">

					{% endif %}

					{{ categorie.name }} <br>
					<span>({{ categorie.microservices|length }} service{{ categorie.microservices|length > 1 ? 's' : '' }}
						disponible)</span>
				</a>
			</li>
			{% endfor %}
		</ul>
	</div>
</div>

<section class="">
	<div class="container py-5">
		<div class="about-section">
			<div class="row align-items-center">
				<div class="col-md-6">
					<img src="{{ asset('img/c-marche.jpg') }}" class="video-img w-100 rounded">
				</div>
				<div class="col-md-6">
					<h2>Comment ça marche?</h2>
					<p class="text-light">
						Trouvez le prestataire qui répondra à vos besoins, parcourez de nombreuses catégories et trouvez des
						prestations dématérialisées pour
						tous vos besoins. Faites votre choix parmi de nombreux prestataires qui mettent leur talent à votre
						disposition.
					</p>
					<div class="row">
						<div class="col-sm-6">
							<ul>
								<li>
									<span><img src="{{ asset('themes/base/images/checkmark.svg') }}">
										Choisissez un service</span>
								</li>
								<li>
									<span><img src="{{ asset('themes/base/images/checkmark.svg') }}">
										Passez une commande
									</span>
								</li>
								<li>
									<span><img src="{{ asset('themes/base/images/checkmark.svg') }}">
										Récupérez votre commande
									</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<section class="py-4">
	<div class="view_slider recommended">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<h3>Services à proximité</h3>
					<div class="view recent-slider recommended-slider">
						{% for microservice in microservices %}
						{{ include('microservice/composants/_bloc.html.twig') }}
						{% endfor %}
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<div class="freelance-projects pb-5">
	<div class="container">
		<h5 class="font-weight-bold pb-3">
			Profésionnels à proximité
		</h5>
		<div class="row freelance-slider">
			{% for vendeur in vendeurs %}

			<div class="col">
				<div class="freelancer">
					{% if vendeur.couverture %}
					<img src="{{ vich_uploader_asset(vendeur, 'couvertureFile') | imagine_filter('midle_size') }}"
						class="img-fluid" alt="{{ vendeur.prenom }}">
					{% else %}

					<img src="{{ asset('themes/base/images/senatopcustudio.jpg') | imagine_filter('midle_size') }}">

					{% endif %}
					<div class="freelancer-footer">

						{% if vendeur.avatar %}
						<img src="{{ vich_uploader_asset(vendeur, 'imageFile') | imagine_filter('medium_avatar') }}"
							class="img-fluid" alt="{{ vendeur.prenom }}">
						{% else %}

						<img class="img-fluid" src="{{ asset('img/user.jpg') | imagine_filter('medium_avatar') }}" alt='' />

						{% endif %}
						<a href="{{ path('vendeur_profil', {nameUrl: vendeur.nameUrl}) }}" class="py-2">
							<h5>{{ vendeur.nom ~ ' ' ~ vendeur.prenom }}</h5>
						</a>
					</div>
				</div>
			</div>

			{% endfor %}
		</div>
	</div>
</div>

<!--<div class="container py-5">
	<div class="pro-section">
		<div class="pro-text">
			<span>Try</span>
			<h3>Unrivaled experts, trusted by the world's biggest brands</h3>
			<a class="fit-btn" href="#">Explore Pro Services</a>
		</div>
	</div>
</div>

<section class="container py-3">
	<div class="" style="position: relative;">
		<div class="sidebar">
			<div class="heading">
				<h3>Prestataires à proximité de vous</h3>
			</div>
			<div id="listings" class="listings"></div>
		</div>
		<div id='map' style='width: 100%; height: 550px;'></div>
	</div>
</section>-->



<div class="modal fade" id="modalLocations" tabindex="-1" aria-labelledby="modalLocationsLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content" style="border-radius: 10px;">
			<div class="modal-header border-0">
				<h5 class="modal-title" id="modalLocationsLabel text-center">Profésionnels autour de vous</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body text-center">
				<p class="lead text-center">
					{{ appName }} souhaite accéder à votre position!
				</p>
				<button id="button-location" class="btn btn-dark">Continuer / Autoriser l'accès à votre position</button>
			</div>
			<div class="modal-footer border-0">
				<button type="button" class="btn btn-outline-light" data-dismiss="modal">Fermer</button>
			</div>
		</div>
	</div>
</div>

{% endblock %}

{% block javascripts %}

{{ parent() }}

<script src="{{ asset('js/favoris.js') }}"></script>

<script>

	$("#button-location").click(function () {

		function getLocation(position) {
			//console.log(position)

			$.ajax({
				method: "POST",
				url: "{{ path('app_service') }}",
				data: {
					longitude: position.coords.longitude,
					latitude: position.coords.latitude
				},
				success: function (response) {
					//alert("Soumis");
					console.log(response)
				},
				error: function (error) {
					alert("Erreur");
				}
			});
		}

		function failedToGet() {
			console.log('Il y a eu une erreur')
		}

		const result = navigator.geolocation.getCurrentPosition(getLocation, failedToGet)


	});

</script>

<script>
	window.onload = function () {     // Array of Images
		var backgroundImg = [
			"{{ asset('img/home-1.png') }}",
			"{{ asset('img/home-2.png') }}",
			"{{ asset('img/home-3.png') }}",
			"{{ asset('img/home-4.png') }}",
			"{{ asset('img/home-5.png') }}",
			"{{ asset('img/home-6.png') }}",
		]
		setInterval(changeImage, 5000);
		function changeImage() {
			var i = Math.floor((Math.random() * 3));

			document.getElementById("home-banner").style.backgroundImage = "url('" + backgroundImg[i] + "')";

		}
	}
</script>

{% endblock %}